/*! bespoke-secondary v0.1.0 Â© 2013 Joel Purra, Licensed MIT */
!function(a,b,c,d,e,f,g,h){"use strict";var i=e.builder(g),j={S:83},k={notes:"aside",keys:{toggle:j.S}},l=function(a,b){var d;b===h&&(b=a,a=0),d=b-a;var e=a+c.floor(c.random()*d);return e},m=g+"-window-",n=function(){var a=l(1e3,1e4),b=m+a;return b},o=function(a){a.body.innerHTML="<h1>Notes</h1><div id='notes'></div>"},p=function(c,e){var f={},g={getNotesElement:function(){return this.secondary.window&&this.secondary.window.document&&this.secondary.window.document.getElementById("notes")},isOpen:function(){var b=this.secondary,c=b.window,d=!0&&b!==h&&null!==c&&c.closed!==!0&&c.opener===a&&null!==this.secondary.getNotesElement();return d},open:function(){return this.secondary.isOpen()||(this.secondary.window=a.open(),o(this.secondary.window.document)),this.secondary.isOpen()},close:function(){return this.secondary.isOpen()&&this.secondary.window.close(),!this.secondary.isOpen()},focus:function(){return this.secondary.isOpen()&&this.secondary.window.focus(),this.secondary.isOpen()},toggle:function(){return this.secondary.isOpen()?this.secondary.close():this.secondary.open(),this.secondary.isOpen()},synchronize:function(){var a,b,c,d;return this.secondary.isOpen()?(a=this.secondary.getNotesElement(),b=this.getActiveSlide(),c=i.copyArray(b.querySelectorAll(e.notes)),d=c.reduce(function(a,b){return a+b.outerHTML},""),a.innerHTML=d,this.secondary.isOpen()):!1}},j=function(){d.plugins.convenient(c,!0),d.plugins.indexfinger(c,!0)},l=function(){c.secondary={window:null,secondaryWindowName:n(),getNotesElement:g.getNotesElement.bind(c),isOpen:g.isOpen.bind(c),open:g.open.bind(c),close:g.close.bind(c),focus:g.focus.bind(c),toggle:g.toggle.bind(c),synchronize:g.synchronize.bind(c)}},m=function(){var a={};a.keys={},a.keys.toggle=e.keys&&e.keys.toggle||k.keys.toggle,a.notes=e.notes||k.notes,e=a},p=function(a){var b=!1;return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey||(b=b||a.which===e.keys.toggle&&i.fire(c,"toggle",a)&&c.secondary.toggle()&&c.secondary.synchronize()),b&&a.preventDefault(),!b},q=function(){return c.secondary.close(),null},r=function(){c.secondary.synchronize()},s=function(){a.onbeforeunload=q,b.addEventListener("keydown",p,!1),f.activate=c.on("activate",r)},t=function(){j(),m(),l(),s()};t()};if(f[g]!==h)throw i.generateErrorObject("The "+g+" plugin has already been loaded.");f[g]=p}(window,document,Math,bespoke,bespoke.plugins.convenient,bespoke.plugins,"secondary");